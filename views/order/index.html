<!doctype html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="../common/reset.css" />
    <link rel="stylesheet" href="../common/common.css" />
    <link rel="stylesheet" href="../common/table.css" />
    <link rel="stylesheet" href="../common/form.css" />
    <link rel="stylesheet" href="../order/order.css" />

    <script type="module" src="../common/header-component.js"></script>
    <script src="../common/footer-component.js"></script>
    <script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>

    <title>order</title>
  </head>

  <body>
    <header-component></header-component>
    <main>
      <div class="container">
        <div class="wrapper">
          <h1>주문 확인 / 결제</h1>
          <div class="order-bill-container">
            <div>
              <section class="section-container section-container-left">
                <h2>주문 상품 정보</h2>
                <table>
                  <thead>
                    <tr>
                      <th>상품이미지</th>
                      <th>상품명</th>
                      <th>상품가격</th>
                      <th>수량</th>
                      <th>총가격</th>
                    </tr>
                  </thead>
                  <tbody id="order-table-body">
                    <template id="order-template">
                      <tr>
                        <td>
                          <!-- 상품이미지 -->
                          <img />
                        </td>
                        <td>
                          <!-- 상품명 -->
                        </td>
                        <td>
                          <!-- 상품가격 -->
                        </td>
                        <td>
                          <!-- 수량 -->
                        </td>
                        <td class="products-price">
                          <!-- 총가격 -->
                        </td>
                      </tr>
                    </template>
                  </tbody>
                </table>
              </section>
              <section class="section-container section-container-left">
                <h2>배송 정보</h2>
                <div class="recipient-info-container">
                  <input
                    class="form-input-alone"
                    id="name"
                    type="text"
                    name="name"
                    placeholder="김춘향"
                  />
                  <input
                    class="form-input-alone"
                    id="phone-number"
                    type="text"
                    name="phone-number"
                  />
                </div>
                <div class="address-container">
                  <input
                    class="form-input-alone"
                    id="zip-code"
                    type="text"
                    name="zipCode"
                    placeholder="우편번호"
                  />
                  <button id="address-popup-button">주소 검색</button>
                  <input
                    class="form-input-alone"
                    id="detail1"
                    type="text"
                    name="detail"
                    placeholder="주소"
                  />
                  <input
                    class="form-input-alone"
                    id="detail2"
                    type="text"
                    name="UserAddressDetail"
                    placeholder="상세주소"
                  />
                </div>
                <h3>배송 메모</h3>
                <select id="deliverySelect" class="section-container">
                  <option value="">배송메모를 선택해 주세요.</option>
                  <option value="배송 전에 미리 연락 바랍니다.">
                    배송 전에 미리 연락 바랍니다.
                  </option>
                  <option value="부재시 경비실에 맡겨주세요.">
                    부재시 경비실에 맡겨주세요.
                  </option>
                  <option value="부재시 전화나 문자를 남겨주세요.">
                    부재시 전화나 문자를 남겨주세요.
                  </option>
                  <option value="custom">직접입력</option>
                </select>
                <div id="custom" style="display: none">
                  <input
                    type="text"
                    id="customInput"
                    placeholder="입력해주세요."
                  />
                </div>
              </section>
            </div>
            <aside>
              <section class="section-container section-container-right">
                <h2>주문 요약</h2>
                <ul>
                  <li class="payments-item">
                    <h3>상품금액</h3>
                    <p><span id="products-price">0</span><span>원</span></p>
                  </li>
                  <li class="payments-item">
                    <h3>배송비</h3>
                    <p><span id="delivery-fee">0</span><span>원</span></p>
                  </li>
                  <hr />
                  <li class="payments-item">
                    <h3>총 주문금액</h3>
                    <p><span id="total-price">0</span><span>원</span></p>
                  </li>
                </ul>
                <button id="payment-button">결제하기</button>
              </section>
              <section class="section-container section-container-right">
                <h2>결제수단</h2>
                <div>
                  <input type="radio" name="pay-type" value="card" id="card" />
                  <label for="card">신용카드</label>
                  <input
                    type="radio"
                    name="pay-type"
                    value="payment-method-1"
                    id="kakaopay"
                  />
                  <label for="kakaopay">카카오페이</label>
                  <input
                    type="radio"
                    name="pay-type"
                    value="payment-method-2"
                    id="naverpay"
                  />
                  <label for="naverpay">네이버페이</label>
                  <input
                    type="radio"
                    name="pay-type"
                    value="bank-pay"
                    id="bankPay"
                  />
                  <label for="bankPay">무통장입금</label>
                  <div class="bank-pay-details" style="display: none">
                    <input
                      class="pay-name"
                      type="text"
                      name="pay-name"
                      placeholder="입금자명(주문자명)"
                    />
                    <h3>입금계좌</h3>
                    <p>NH농협 302-0000-0000-00 이춘향</p>
                    <h3>입금자명</h3>
                    <input type="text" />
                    <p>주문 후 48시간 이내 미입금시 자동 취소됩니다.</p>
                  </div>
                </div>
              </section>
            </aside>
          </div>
        </div>
      </div>
    </main>
    <!-- <footer-component></footer-component> -->
    <script type="module" src="order.js"></script>
    <!-- 주소 api js 파일에 넣으니 오류가 떠서 코드 이동 -->
    <script>
      const openAddressButtonElement = document.querySelector(
        "#address-popup-button",
      );
      const zipCodeElement = document.querySelector("#zip-code");
      const detail1Element = document.querySelector("#detail1");
      const detail2Element = document.querySelector("#detail2");

      openAddressButtonElement.addEventListener("click", openAddressPopup);
      zipCodeElement.addEventListener("click", openAddressPopup);
      detail1Element.addEventListener("click", openAddressPopup);

      function openAddressPopup() {
        new daum.Postcode({
          oncomplete: function (data) {
            var address = "";
            var extraAddress = "";

            if (data.userSelectedType === "R") {
              address = data.roadAddress;
            } else {
              address = data.jibunAddress;
            }

            if (data.userSelectedType === "R") {
              if (data.bname !== "" && /[동|로|가]$/g.test(data.bname)) {
                extraAddress += data.bname;
              }
              if (data.buildingName !== "" && data.apartment === "Y") {
                extraAddress +=
                  extraAddress !== ""
                    ? ", " + data.buildingName
                    : data.buildingName;
              }
              if (extraAddress !== "") {
                extraAddress = " (" + extraAddress + ")";
              }
              zipCodeElement.value = data.zonecode;
              detail1Element.value = address;
              document.getElementById("detail2").focus();
            } else {
              zipCodeElement.value = "";
              detail1Element.value = "";
            }
          },
        }).open();
      }
    </script>
  </body>
</html>
